/*!
 * vimeo.ga.js | v0.2
 * Copyright (c) 2012 - 2013 Sander Heilbron (http://sanderheilbron.nl)
 * MIT licensed
 */

$(function(){function s(e){if(e.origin!=="http://player.vimeo.com"){return}var n=JSON.parse(e.data);switch(n.event){case"ready":u();break;case"playProgress":f(n.data);break;case"seek":if(i&&!videoSeeking){ga("send","event","Vimeo","Skipped video forward or backward",t,undefined,true);videoSeeking=true}break;case"play":if(!videoPlayed){ga("send","event","Vimeo","Started video",t,undefined,true);videoPlayed=true}break;case"pause":a();break;case"finish":if(!videoCompleted){ga("send","event","Vimeo","Completed video",t,undefined,true);videoCompleted=true}break}}function o(n,r){var i={method:n};if(r){i.value=r}e[0].contentWindow.postMessage(JSON.stringify(i),t)}function u(){o("addEventListener","play");o("addEventListener","seek");o("addEventListener","pause");o("addEventListener","finish");o("addEventListener","playProgress");progress25=false;progress50=false;progress75=false;videoPlayed=false;videoPaused=false;videoSeeking=false;videoCompleted=false}function a(){if(timePercentComplete<99&&!videoPaused){ga("send","event","Vimeo","Paused video",t,undefined,true);videoPaused=true}}function f(e){timePercentComplete=Math.round(e.percent*100);if(!r){return}var n;if(timePercentComplete>24&&!progress25){n="Played video: 25%";progress25=true}if(timePercentComplete>49&&!progress50){n="Played video: 50%";progress50=true}if(timePercentComplete>74&&!progress75){n="Played video: 75%";progress75=true}if(n){ga("send","event","Vimeo",n,t,undefined,true)}}var e=$("iframe"),t=e.attr("src").split("?")[0],n=new RegExp(/^http:/),r=e.data("progress"),i=e.data("seek");if(n.test(t)==false){t="http:"+t}if(window.addEventListener){window.addEventListener("message",s,false)}else{window.attachEvent("onmessage",s,false)}})